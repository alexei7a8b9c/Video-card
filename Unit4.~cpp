//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit1.h"
#include "Unit2.h"
#include "Unit3.h"
#include "Unit4.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma resource "*.dfm"
TForm4 *Form4;
//---------------------------------------------------------------------------
__fastcall TForm4::TForm4(TComponent* Owner)
        : TForm(Owner)
{
}
//---------------------------------------------------------------------------


void __fastcall TForm4::FormCreate(TObject *Sender)
{
//Ширина столбцов
DBGrid1->Columns->Items[0]->Width =50;
DBGrid1->Columns->Items[0]->Visible=false;

DBGrid1->Columns->Items[1]->Width =300;
DBGrid1->Columns->Items[1]->Title->Caption = "Видеокарта";

DBGrid1->Columns->Items[2]->Width =80;
DBGrid1->Columns->Items[2]->Title->Caption = "Количество";

DBGrid1->Columns->Items[3]->Width =80;
DBGrid1->Columns->Items[3]->Title->Caption = "Цена";

DBGrid1->Columns->Items[4]->Width =150;
DBGrid1->Columns->Items[4]->Title->Caption = "Интерфейс";

DBGrid1->Columns->Items[5]->Width =220;
DBGrid1->Columns->Items[5]->Title->Caption = "Производитель графического процессора";

DBGrid1->Columns->Items[6]->Width =150;
DBGrid1->Columns->Items[6]->Title->Caption = "Графический процессор";

DBGrid1->Columns->Items[7]->Width =150;
DBGrid1->Columns->Items[7]->Title->Caption = "Частота граф. процессора";

DBGrid1->Columns->Items[8]->Width =110;
DBGrid1->Columns->Items[8]->Title->Caption = "Количество потоков";

DBGrid1->Columns->Items[9]->Width =120;
DBGrid1->Columns->Items[9]->Title->Caption = "Объем видеопамяти";

DBGrid1->Columns->Items[10]->Width =100;
DBGrid1->Columns->Items[10]->Title->Caption = "Тип видеопамяти";

DBGrid1->Columns->Items[11]->Width =150;
DBGrid1->Columns->Items[11]->Title->Caption = "Частота памяти";

DBGrid1->Columns->Items[12]->Width =120;
DBGrid1->Columns->Items[12]->Title->Caption = "Ширина шины памяти";

DBGrid1->Columns->Items[13]->Width =70;
DBGrid1->Columns->Items[13]->Title->Caption = "DirectX";

DBGrid1->Columns->Items[14]->Width =150;
DBGrid1->Columns->Items[14]->Title->Caption = "Мощность блока питания";

DBGrid1->Columns->Items[15]->Width =100;
DBGrid1->Columns->Items[15]->Title->Caption = "Гарантия";

DBGrid1->Columns->Items[16]->Width =150;
DBGrid1->Columns->Items[17]->Width =150;
DBGrid1->Columns->Items[18]->Width =150;

DBGrid1->Columns->Items[16]->Visible=false;
DBGrid1->Columns->Items[17]->Visible=false;
DBGrid1->Columns->Items[18]->Visible=false;        
}
//---------------------------------------------------------------------------
void __fastcall TForm4::ListBox1Click(TObject *Sender)
{
if( ListBox1->ItemIndex == 0)
Edit2->Text = Edit2->Text + "[Videocard]" + "='" + "'";
if( ListBox1->ItemIndex == 1)
Edit2->Text = Edit2->Text + "[Kol]" + "='" + "'";
if( ListBox1->ItemIndex == 2)
Edit2->Text = Edit2->Text + "[Cena]" + "='" + "'";
if( ListBox1->ItemIndex == 3)
Edit2->Text = Edit2->Text + "[Proizv_graf_processora]" + "='" + "'";
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn2Click(TObject *Sender)
{
Edit2->Clear();        
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn3Click(TObject *Sender)
{
 Edit2->Text = Edit2->Text + " AND ";        
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn4Click(TObject *Sender)
{
 Edit2->Text = Edit2->Text + " OR ";        
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn5Click(TObject *Sender)
{
Edit2->Text = Edit2->Text + " > ";        
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn6Click(TObject *Sender)
{
Edit2->Text = Edit2->Text + " < ";
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn7Click(TObject *Sender)
{
Form4->ADOTable1->Filter = Edit2->Text;
 Form4->ADOTable1->Filtered = true;
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn8Click(TObject *Sender)
{
Form4->Close();
}
//---------------------------------------------------------------------------
void __fastcall TForm4::BitBtn9Click(TObject *Sender)
{
Form4->ADOTable1->Filtered = false;
Form4->Close();
}
//---------------------------------------------------------------------------

